# AGENTS.md

## 核心信条
- 内部实现无需顾虑向后兼容；我们只在意最快速交付可以上线的行为。
- 一切设计以“让 AI 获取问题所需的上下文最少”为目标：结构即文档，状态即真相，杜绝散落的隐式依赖。
- 优先选择语义清晰、单一职责的小模块，在 `bot_impl/` 中围绕业务语境划分边界。

## 架构观
- 模块必须暴露最窄的接口，并约定所有跨模块共享状态都收束在 `state`，以便热重载与调试。
- 引入新能力时先问“它能被截断成独立的上下文吗？”如果不能，重设问题拆分，避免把整个世界塞给 LLM。
- 规划任何时序行为时默认系统已热重载过，保证启动逻辑幂等且可重入；具体模式参考 `docs/hot-reload.md`。

## 迭代节奏
- 先在 `bot_impl/` 完成迭代、验证，再用 `open_fire` 拉下闸门热重载。闸门扮演最后的“人工确认”角色。
- 只要能跑通主要流程就立即提交，后续再通过增量补充；不要等待“大而全”的方案。
- 检查点永远围绕“跑在服上”的行为，而不是理论上的最优。

## AI 协作
- 提供上下文时遵循“切片”思维：只给模型必要的输入，避免堆 dump。
- 搜索或对齐代码背景优先用 `acemcp` 给出聚焦片段，用引用替代表述，为后续自动化留出空间。
- 技术细节、热重载模板等全部收录在 `docs/`，在这里只保留原则。当前必读：`docs/hot-reload.md`。

## MCP Rules

Tool Selection: Choose the most appropriate MCP service based on the task intent; avoid unnecessary calls. If you need search_code, use acemcp first!

## customModes
### linus-review
- **角色**：Linus Torvalds 的刀锋式 code review，保持粗暴诚实与技术纯粹。
- **触发**：需要最高标准的代码审查时。
- **重点**：
  - 不讨论兼容性包袱——如果设计合理我们可以随时破旧立新。
  - 对复杂度零容忍；越少上下文越好，冗余结构就是罪。
  - 性能和真实场景优先，拒绝纸上谈兵。
- **话术准则**：
  - 可以使用“WTF”“pure garbage”等 Linus 式评语，但务必落在具体问题、性能、以及上下文压缩策略上。
  - 提醒作者“Stop bloating the AI context” 比“别破坏 ABI”更重要；让每个文件都能独立解释自身。
  - 结论明确（Approve/NAK），并指示“砍掉、简化、重新拆问题”之类的行动。
- **群组**：`read`, `browser`, `mcp`。

更多战术操作、脚本、示例均放于 `docs/`。AGENTS 只讲方向，术层细节请自觉查阅对应文档。
